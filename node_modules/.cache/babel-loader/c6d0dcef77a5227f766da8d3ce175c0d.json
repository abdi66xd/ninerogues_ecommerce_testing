{"ast":null,"code":"var _jsxFileName = \"D:\\\\tutos\\\\ninerogues_ecommerce\\\\src\\\\containers\\\\pages\\\\Checkout.jsx\",\n    _s = $RefreshSig$();\n\nimport Layout from '../../hocs/Layout';\nimport { Navigate } from 'react-router';\nimport { connect } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport CartItem from '../../components/cart/CartItem';\nimport { setAlert } from '../../redux/actions/alert';\nimport { update_item, remove_item } from '../../redux/actions/cart';\nimport { useEffect, useState } from 'react';\nimport { get_shipping_options } from '../../redux/actions/shipping';\nimport { check_coupon } from '../../redux/actions/coupons';\nimport { refresh } from '../../redux/actions/auth';\nimport { get_payment_total, get_client_token, process_payment } from '../../redux/actions/payment';\nimport DropIn from 'braintree-web-drop-in-react';\nimport Loader from 'react-loader-spinner';\nimport { countries } from '../../helpers/fixedCountries';\nimport ShippingForm from '../../components/checkout/ShippingForm';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst Checkout = _ref => {\n  _s();\n\n  let {\n    isAuthenticated,\n    items,\n    update_item,\n    remove_item,\n    setAlert,\n    get_shipping_options,\n    shipping,\n    refresh,\n    get_payment_total,\n    get_client_token,\n    process_payment,\n    user,\n    total_items,\n    clientToken,\n    made_payment,\n    loading,\n    original_price,\n    total_after_coupon,\n    total_amount,\n    total_compare_amount,\n    estimated_tax,\n    shipping_cost,\n    check_coupon,\n    coupon\n  } = _ref;\n  const [formData, setFormData] = useState({\n    full_name: '',\n    address_line_1: '',\n    address_line_2: '',\n    city: '',\n    state_province_region: '',\n    postal_zip_code: '',\n    country_region: 'Peru',\n    telephone_number: '',\n    coupon_name: '',\n    shipping_id: 0\n  });\n  const [data, setData] = useState({\n    instance: {}\n  });\n  const {\n    full_name,\n    address_line_1,\n    address_line_2,\n    city,\n    state_province_region,\n    postal_zip_code,\n    country_region,\n    telephone_number,\n    coupon_name,\n    shipping_id\n  } = formData;\n\n  const onChange = e => setFormData({ ...formData,\n    [e.target.name]: e.target.value\n  });\n\n  const buy = async e => {\n    e.preventDefault();\n    let nonce = await data.instance.requestPaymentMethod();\n\n    if (coupon && coupon !== null && coupon !== undefined) {\n      process_payment(nonce, shipping_id, coupon.name, full_name, address_line_1, address_line_2, city, state_province_region, postal_zip_code, country_region, telephone_number);\n    } else {\n      process_payment(nonce, shipping_id, '', full_name, address_line_1, address_line_2, city, state_province_region, postal_zip_code, country_region, telephone_number);\n    }\n  };\n\n  const apply_coupon = async e => {\n    e.preventDefault();\n    check_coupon(coupon_name);\n  };\n\n  useEffect(() => {\n    window.scrollTo(0, 0);\n    get_shipping_options();\n  }, []);\n  useEffect(() => {\n    get_client_token();\n  }, [user]);\n  useEffect(() => {\n    if (coupon && coupon !== null && coupon !== undefined) get_payment_total(shipping_id, coupon.name);else get_payment_total(shipping_id, 'default');\n  }, [shipping_id, coupon]);\n  const [render, setRender] = useState(false);\n  if (!isAuthenticated) return /*#__PURE__*/_jsxDEV(Navigate, {\n    to: \"/\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 144,\n    columnNumber: 16\n  }, this);\n\n  const showItems = () => {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: items && items !== null && items !== undefined && items.length !== 0 && items.map((item, index) => {\n        let count = item.count;\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(CartItem, {\n            item: item,\n            count: count,\n            update_item: update_item,\n            remove_item: remove_item,\n            render: render,\n            setRender: setRender,\n            setAlert: setAlert\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 158,\n            columnNumber: 33\n          }, this)\n        }, index, false, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 29\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 13\n    }, this);\n  };\n\n  const renderShipping = () => {\n    if (shipping && shipping !== null && shipping !== undefined) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-5\",\n        children: shipping.map((shipping_option, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            onChange: e => onChange(e),\n            value: shipping_option.id,\n            name: \"shipping_id\",\n            type: \"radio\",\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 182,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"ml-4\",\n            children: [shipping_option.name, \" - $\", shipping_option.price, \" (\", shipping_option.time_to_delivery, \")\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 189,\n            columnNumber: 33\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 29\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 17\n      }, this);\n    }\n  };\n\n  const renderPaymentInfo = () => {\n    if (!clientToken) {\n      if (!isAuthenticated) {\n        /*#__PURE__*/\n        _jsxDEV(Link, {\n          to: \"/login\",\n          className: \"w-full bg-gray-600 border border-transparent rounded-md shadow-sm py-3 px-4 text-base font-medium text-white hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-50 focus:ring-gray-500\",\n          children: \"Login\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 13\n        }, this);\n      } else {\n        /*#__PURE__*/\n        _jsxDEV(\"button\", {\n          className: \"w-full bg-indigo-600 border border-transparent rounded-md shadow-sm py-3 px-4 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-50 focus:ring-indigo-500\",\n          children: /*#__PURE__*/_jsxDEV(Loader, {\n            type: \"Oval\",\n            color: \"#fff\",\n            height: 20,\n            widht: 20\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 213,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 11\n        }, this);\n      }\n    } else {\n      return /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(DropIn, {\n          options: {\n            authorization: clientToken,\n            paypal: {\n              flow: 'vault'\n            }\n          },\n          onInstance: instance => data.instance = instance\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-6\",\n          children: loading ? /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"w-full bg-indigo-600 border border-transparent rounded-md shadow-sm py-3 px-4 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-50 focus:ring-indigo-500\",\n            children: /*#__PURE__*/_jsxDEV(Loader, {\n              type: \"Oval\",\n              color: \"#fff\",\n              height: 20,\n              widht: 20\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 237,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 234,\n            columnNumber: 24\n          }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            className: \"w-full bg-green-600 border border-transparent rounded-md shadow-sm py-3 px-4 text-base font-medium text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-50 focus:ring-green-500\",\n            children: \"Place Order\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 244,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true);\n    }\n  };\n\n  if (made_payment) return /*#__PURE__*/_jsxDEV(Navigate, {\n    to: \"/thankyou\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 257,\n    columnNumber: 16\n  }, this);\n  return /*#__PURE__*/_jsxDEV(Layout, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"max-w-2xl mx-auto pt-16 pb-24 px-4 sm:px-6 lg:max-w-7xl lg:px-8\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-3xl font-extrabold tracking-tight text-gray-900 sm:text-4xl\",\n          children: \"Checkout\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"mt-12 lg:grid lg:grid-cols-12 lg:gap-x-12 lg:items-start xl:gap-x-16\",\n          children: [/*#__PURE__*/_jsxDEV(\"section\", {\n            \"aria-labelledby\": \"cart-heading\",\n            className: \"lg:col-span-7\",\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              id: \"cart-heading\",\n              className: \"sr-only\",\n              children: \"Items in your shopping cart\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 266,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n              className: \"border-t border-b border-gray-200 divide-y divide-gray-200\",\n              children: showItems()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 270,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 265,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(ShippingForm, {\n            full_name: full_name,\n            address_line_1: address_line_1,\n            address_line_2: address_line_2,\n            city: city,\n            state_province_region: state_province_region,\n            postal_zip_code: postal_zip_code,\n            telephone_number: telephone_number,\n            countries: countries,\n            onChange: onChange,\n            buy: buy,\n            user: user,\n            renderShipping: renderShipping,\n            total_amount: total_amount,\n            total_after_coupon: total_after_coupon,\n            total_compare_amount: total_compare_amount,\n            estimated_tax: estimated_tax,\n            shipping_cost: shipping_cost,\n            shipping_id: shipping_id,\n            shipping: shipping,\n            renderPaymentInfo: renderPaymentInfo,\n            coupon: coupon,\n            apply_coupon: apply_coupon,\n            coupon_name: coupon_name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 277,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 260,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Checkout, \"LO1inehE8uify826fzF7ZceZ5AQ=\");\n\n_c = Checkout;\n\nconst mapStateToProps = state => ({\n  isAuthenticated: state.Auth.isAuthenticated,\n  user: state.Auth.user,\n  items: state.Cart.items,\n  total_items: state.Cart.total_items,\n  shipping: state.Shipping.shipping,\n  clientToken: state.Payment.clientToken,\n  made_payment: state.Payment.made_payment,\n  loading: state.Payment.loading,\n  original_price: state.Payment.original_price,\n  total_after_coupon: state.Payment.total_after_coupon,\n  total_amount: state.Payment.total_amount,\n  total_compare_amount: state.Payment.total_compare_amount,\n  estimated_tax: state.Payment.estimated_tax,\n  shipping_cost: state.Payment.shipping_cost,\n  coupon: state.Coupons.coupon\n});\n\nexport default connect(mapStateToProps, {\n  update_item,\n  remove_item,\n  setAlert,\n  get_shipping_options,\n  refresh,\n  get_payment_total,\n  get_client_token,\n  process_payment,\n  check_coupon\n})(Checkout);\n\nvar _c;\n\n$RefreshReg$(_c, \"Checkout\");","map":{"version":3,"sources":["D:/tutos/ninerogues_ecommerce/src/containers/pages/Checkout.jsx"],"names":["Layout","Navigate","connect","Link","CartItem","setAlert","update_item","remove_item","useEffect","useState","get_shipping_options","check_coupon","refresh","get_payment_total","get_client_token","process_payment","DropIn","Loader","countries","ShippingForm","Checkout","isAuthenticated","items","shipping","user","total_items","clientToken","made_payment","loading","original_price","total_after_coupon","total_amount","total_compare_amount","estimated_tax","shipping_cost","coupon","formData","setFormData","full_name","address_line_1","address_line_2","city","state_province_region","postal_zip_code","country_region","telephone_number","coupon_name","shipping_id","data","setData","instance","onChange","e","target","name","value","buy","preventDefault","nonce","requestPaymentMethod","undefined","apply_coupon","window","scrollTo","render","setRender","showItems","length","map","item","index","count","renderShipping","shipping_option","id","price","time_to_delivery","renderPaymentInfo","authorization","paypal","flow","mapStateToProps","state","Auth","Cart","Shipping","Payment","Coupons"],"mappings":"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","sourcesContent":["import Layout from '../../hocs/Layout'\r\nimport { Navigate } from 'react-router'\r\nimport { connect } from 'react-redux'\r\nimport { Link } from 'react-router-dom'\r\nimport CartItem from '../../components/cart/CartItem'\r\nimport { setAlert } from '../../redux/actions/alert'\r\nimport { update_item, remove_item } from '../../redux/actions/cart'\r\nimport { useEffect, useState } from 'react'\r\nimport {get_shipping_options} from '../../redux/actions/shipping'\r\nimport {check_coupon} from '../../redux/actions/coupons'\r\nimport {\r\n  refresh\r\n} from '../../redux/actions/auth';\r\n\r\nimport {\r\n  get_payment_total,\r\n  get_client_token,\r\n  process_payment\r\n} from '../../redux/actions/payment';\r\n\r\nimport DropIn from 'braintree-web-drop-in-react';\r\nimport Loader from 'react-loader-spinner';\r\nimport {countries} from '../../helpers/fixedCountries'\r\nimport ShippingForm from '../../components/checkout/ShippingForm'\r\n\r\nconst Checkout = ({\r\n    isAuthenticated, \r\n    items,\r\n    update_item,\r\n    remove_item,\r\n    setAlert,\r\n    get_shipping_options,\r\n    shipping,\r\n    refresh,\r\n    get_payment_total,\r\n    get_client_token,\r\n    process_payment,\r\n    user,\r\n    total_items,\r\n    clientToken,\r\n    made_payment,\r\n    loading,\r\n    original_price,\r\n    total_after_coupon,\r\n    total_amount,\r\n    total_compare_amount,\r\n    estimated_tax,\r\n    shipping_cost,\r\n    check_coupon,\r\n    coupon\r\n}) => {\r\n\r\n    const [formData, setFormData] = useState({\r\n        full_name: '',\r\n        address_line_1: '',\r\n        address_line_2: '',\r\n        city: '',\r\n        state_province_region: '',\r\n        postal_zip_code: '',\r\n        country_region: 'Peru',\r\n        telephone_number: '',\r\n        coupon_name: '',\r\n        shipping_id: 0,\r\n    });\r\n\r\n    const [data, setData] = useState({\r\n        instance: {}\r\n    });\r\n\r\n    const { \r\n        full_name,\r\n        address_line_1,\r\n        address_line_2,\r\n        city,\r\n        state_province_region,\r\n        postal_zip_code,\r\n        country_region,\r\n        telephone_number,\r\n        coupon_name,\r\n        shipping_id,\r\n    } = formData;\r\n\r\n    const onChange = e => setFormData({ ...formData, [e.target.name]: e.target.value });\r\n\r\n    const buy = async e => {\r\n        e.preventDefault();\r\n        let nonce = await data.instance.requestPaymentMethod();\r\n        if (coupon && coupon !== null && coupon !== undefined) {\r\n          process_payment(\r\n              nonce,\r\n              shipping_id,\r\n              coupon.name,\r\n              full_name,\r\n              address_line_1,\r\n              address_line_2,\r\n              city,\r\n              state_province_region,\r\n              postal_zip_code,\r\n              country_region,\r\n              telephone_number\r\n          );\r\n        } else {\r\n          process_payment(\r\n              nonce,\r\n              shipping_id,\r\n              '',\r\n              full_name,\r\n              address_line_1,\r\n              address_line_2,\r\n              city,\r\n              state_province_region,\r\n              postal_zip_code,\r\n              country_region,\r\n              telephone_number\r\n          );\r\n      }\r\n    }\r\n\r\n    const apply_coupon = async e => {\r\n      e.preventDefault();\r\n\r\n        check_coupon(coupon_name);\r\n    };\r\n\r\n    useEffect(() => {\r\n      window.scrollTo(0,0)\r\n      get_shipping_options()\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n      get_client_token();\r\n  }, [user]);\r\n  \r\n  useEffect(() => {\r\n    if (coupon && coupon !== null && coupon !== undefined)\r\n        get_payment_total(shipping_id, coupon.name);\r\n    else\r\n        get_payment_total(shipping_id, 'default');\r\n  }, [shipping_id, coupon]);\r\n\r\n    const [render, setRender] = useState(false);\r\n\r\n    if(!isAuthenticated)\r\n        return <Navigate to='/' />;\r\n\r\n    const showItems = () => {\r\n        return(\r\n            <div>\r\n                {\r\n                    items && \r\n                    items !== null && \r\n                    items !== undefined && \r\n                    items.length !== 0 && \r\n                    items.map((item, index)=>{\r\n                        let count = item.count;\r\n                        return (\r\n                            <div key={index}>\r\n                                <CartItem \r\n                                    item={item}\r\n                                    count={count}\r\n                                    update_item={update_item}\r\n                                    remove_item={remove_item}\r\n                                    render={render}\r\n                                    setRender={setRender}\r\n                                    setAlert={setAlert}\r\n                                />\r\n                            </div>\r\n                        );\r\n                    })\r\n                }\r\n            </div>\r\n        )\r\n    }\r\n\r\n    const renderShipping = () => {\r\n        if (shipping && shipping !== null && shipping !== undefined) {\r\n            return (\r\n                <div className='mb-5'>\r\n                    {\r\n                        shipping.map((shipping_option, index) => (\r\n                            <div key={index}>\r\n                                <input\r\n                                    onChange={e => onChange(e)}\r\n                                    value={shipping_option.id}\r\n                                    name='shipping_id'\r\n                                    type='radio'\r\n                                    required\r\n                                />\r\n                                <label className='ml-4'>\r\n                                    {shipping_option.name} - ${shipping_option.price} ({shipping_option.time_to_delivery})\r\n                                </label>\r\n                            </div>\r\n                        ))\r\n                    }\r\n                </div>\r\n            );\r\n        }\r\n    };\r\n\r\n    const renderPaymentInfo = () => {\r\n      if (!clientToken) {\r\n        if (!isAuthenticated) {\r\n            <Link\r\n              to=\"/login\"\r\n              className=\"w-full bg-gray-600 border border-transparent rounded-md shadow-sm py-3 px-4 text-base font-medium text-white hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-50 focus:ring-gray-500\"\r\n            >\r\n              Login\r\n            </Link>\r\n        } else {\r\n          <button\r\n            className=\"w-full bg-indigo-600 border border-transparent rounded-md shadow-sm py-3 px-4 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-50 focus:ring-indigo-500\"\r\n          >\r\n            <Loader\r\n              type='Oval'\r\n              color='#fff'\r\n              height={20}\r\n              widht={20}\r\n            />\r\n          </button>\r\n        }\r\n      } else {\r\n        return (\r\n          <>\r\n            <DropIn\r\n              options={{\r\n                  authorization: clientToken,\r\n                  paypal: {\r\n                      flow: 'vault'\r\n                  }\r\n              }}\r\n              onInstance={instance => (data.instance = instance)}\r\n            />\r\n            <div className=\"mt-6\">\r\n              {loading?<button\r\n                className=\"w-full bg-indigo-600 border border-transparent rounded-md shadow-sm py-3 px-4 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-50 focus:ring-indigo-500\"\r\n              >\r\n                <Loader\r\n                  type='Oval'\r\n                  color='#fff'\r\n                  height={20}\r\n                  widht={20}\r\n                />\r\n              </button>:\r\n              <button\r\n              type=\"submit\"\r\n              className=\"w-full bg-green-600 border border-transparent rounded-md shadow-sm py-3 px-4 text-base font-medium text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-50 focus:ring-green-500\"\r\n            >\r\n              Place Order\r\n            </button>}\r\n            </div>\r\n          </>\r\n        )\r\n      }\r\n    }\r\n\r\n    if (made_payment)\r\n        return <Navigate to='/thankyou' />;\r\n\r\n    return (\r\n        <Layout>\r\n            <div className=\"bg-white\">\r\n      <div className=\"max-w-2xl mx-auto pt-16 pb-24 px-4 sm:px-6 lg:max-w-7xl lg:px-8\">\r\n        <h1 className=\"text-3xl font-extrabold tracking-tight text-gray-900 sm:text-4xl\">Checkout</h1>\r\n        <div className=\"mt-12 lg:grid lg:grid-cols-12 lg:gap-x-12 lg:items-start xl:gap-x-16\">\r\n          <section aria-labelledby=\"cart-heading\" className=\"lg:col-span-7\">\r\n            <h2 id=\"cart-heading\" className=\"sr-only\">\r\n              Items in your shopping cart\r\n            </h2>\r\n\r\n            <ul className=\"border-t border-b border-gray-200 divide-y divide-gray-200\">\r\n              {showItems()}\r\n            </ul>\r\n          </section>\r\n\r\n          {/* Order summary */}\r\n\r\n          <ShippingForm\r\n              full_name={full_name}\r\n              address_line_1={address_line_1}\r\n              address_line_2={address_line_2}\r\n              city={city}\r\n              state_province_region={state_province_region}\r\n              postal_zip_code={postal_zip_code}\r\n              telephone_number={telephone_number}\r\n              countries={countries}\r\n              onChange={onChange}\r\n              buy={buy}\r\n              user={user}\r\n              renderShipping={renderShipping}\r\n              total_amount={total_amount}\r\n              total_after_coupon={total_after_coupon}\r\n              total_compare_amount={total_compare_amount}\r\n              estimated_tax={estimated_tax}\r\n              shipping_cost={shipping_cost}\r\n              shipping_id={shipping_id}\r\n              shipping={shipping}\r\n              renderPaymentInfo={renderPaymentInfo}\r\n              coupon={coupon}\r\n              apply_coupon={apply_coupon}\r\n              coupon_name={coupon_name}\r\n            />\r\n\r\n          \r\n        </div>\r\n      </div>\r\n    </div>\r\n        </Layout>\r\n    )\r\n}\r\nconst mapStateToProps = state => ({\r\n    isAuthenticated: state.Auth.isAuthenticated,\r\n    user: state.Auth.user,\r\n    items: state.Cart.items,\r\n    total_items: state.Cart.total_items,\r\n    shipping: state.Shipping.shipping,\r\n    clientToken: state.Payment.clientToken,\r\n    made_payment: state.Payment.made_payment,\r\n    loading: state.Payment.loading,\r\n    original_price: state.Payment.original_price,\r\n    total_after_coupon: state.Payment.total_after_coupon,\r\n    total_amount: state.Payment.total_amount,\r\n    total_compare_amount: state.Payment.total_compare_amount,\r\n    estimated_tax: state.Payment.estimated_tax,\r\n    shipping_cost: state.Payment.shipping_cost,\r\n    coupon: state.Coupons.coupon,\r\n})\r\n\r\nexport default connect(mapStateToProps,{\r\n    update_item,\r\n    remove_item,\r\n    setAlert,\r\n    get_shipping_options,\r\n    refresh,\r\n    get_payment_total,\r\n    get_client_token,\r\n    process_payment,\r\n    check_coupon\r\n}) (Checkout)"]},"metadata":{},"sourceType":"module"}